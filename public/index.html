<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#0B0F1A">
  <title>FinLogicHub5 â€” Daily Market Risk Signal</title>
  <meta name="description" content="FinLogicHub5 delivers a Daily Market Risk Signal with allocation guidance, weekly strategy, and risk archive. Check todayâ€™s MRI in seconds.">
  <link rel="canonical" href="https://finlogichub5.com/">
  <link rel="prefetch" href="/weekly/" />
  <link rel="prefetch" href="/archive/" />
  <!-- MRI_OG_START -->
<meta property="og:type" content="website">
<meta property="og:title" content="MRI 32 Â· MEDIUM Â· 2026-02-27">
<meta property="og:description" content="ðŸ“Š ä»Šæ—¥å¸‚åœºé£Žé™©æŒ‡æ•°ï¼ˆMRIï¼‰ï¼š32 (0)
é£Žé™©ç­‰çº§ï¼šä¸­æ€§
å»ºè®®è‚¡ç¥¨ä»“ä½ï¼š40-60%
è¶‹åŠ¿ï¼šé£Žé™©ç¨³å®š
ç½®ä¿¡åº¦ï¼šä½Ž

æŸ¥çœ‹å®Œæ•´æŒ‡æ•° â†’ https://finlogichub5.com">
<meta property="og:url" content="https://finlogichub5.com/">
<meta property="og:site_name" content="FinLogicHub5">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://finlogichub5.com/og/mri-latest.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="MRI 32 Â· MEDIUM Â· 2026-02-27">
<meta name="twitter:description" content="ðŸ“Š ä»Šæ—¥å¸‚åœºé£Žé™©æŒ‡æ•°ï¼ˆMRIï¼‰ï¼š32 (0)
é£Žé™©ç­‰çº§ï¼šä¸­æ€§
å»ºè®®è‚¡ç¥¨ä»“ä½ï¼š40-60%
è¶‹åŠ¿ï¼šé£Žé™©ç¨³å®š
ç½®ä¿¡åº¦ï¼šä½Ž

æŸ¥çœ‹å®Œæ•´æŒ‡æ•° â†’ https://finlogichub5.com">
<meta name="twitter:image" content="https://finlogichub5.com/og/mri-latest.png">
<!-- MRI_OG_END -->
  <link rel="preload" as="fetch" href="/data/latest.json" crossorigin>
  <link rel="preload" as="fetch" href="/data/risk_index.json" crossorigin>
  <link rel="preload" as="fetch" href="/data/risk_index_history.json" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0B0F1A;
      --panel: rgba(12, 19, 32, 0.7);
      --text: #E5EDFF;
      --muted: #8FA3C8;
      --cyan: #00E5FF;
      --purple: #7B61FF;
      --green: #4ADE80;
      --yellow: #FACC15;
      --red: #F87171;
      --glass: rgba(15, 23, 42, 0.65);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Space Grotesk", sans-serif;
      background: radial-gradient(1200px 700px at 12% -10%, rgba(0,229,255,0.18), transparent 60%),
                  radial-gradient(900px 600px at 90% -20%, rgba(123,97,255,0.18), transparent 60%),
                  #0B0F1A;
      color: var(--text);
    }
    a { color: inherit; text-decoration: none; }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    .nav {
      display: flex; align-items: center; justify-content: space-between; gap: 18px; flex-wrap: wrap;
      padding: 12px 0 24px 0; border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .brand { font-weight: 700; letter-spacing: 0.6px; font-size: 14px; color: #E2F4FF; }
    .nav-links { display: flex; gap: 16px; flex-wrap: wrap; font-size: 12px; color: var(--muted); }
    .nav-links a { padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,0.04); }
    .nav-links a:hover { color: #fff; border: 1px solid rgba(0,229,255,0.35); }

    .hero { min-height: 78vh; display: grid; align-items: center; position: relative; overflow: hidden; }
    .hero::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 32px 32px;
      opacity: 0.35;
      pointer-events: none;
    }
    .hero::after {
      content: "";
      position: absolute;
      width: 520px;
      height: 520px;
      right: -120px;
      top: -160px;
      background: radial-gradient(circle, rgba(0,229,255,0.25), transparent 70%);
      filter: blur(0px);
      pointer-events: none;
    }
    .hero-grid { display: grid; grid-template-columns: 7fr 3fr; gap: 24px; position: relative; z-index: 1; }
    .hero-left .title { font-size: clamp(22px, 3vw, 28px); letter-spacing: 1px; text-transform: uppercase; color: var(--muted); margin-bottom: 10px; }
    .hero-left .mri { font-size: clamp(56px, 10vw, 110px); font-weight: 700; line-height: 1; }
    .hero-left .meta { margin-top: 14px; display: flex; flex-wrap: wrap; gap: 12px 20px; font-size: 14px; color: #CFE9FF; }
    .hero-right { background: var(--glass); border: 1px solid rgba(255,255,255,0.08); border-radius: 18px; padding: 18px; }
    .box-title { font-size: 12px; text-transform: uppercase; letter-spacing: 0.8px; color: var(--muted); }
    .ranges { margin: 12px 0; display: grid; gap: 6px; font-size: 14px; }
    .cta { display: grid; gap: 10px; margin-top: 12px; }
    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 12px 16px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); color: var(--text); }
    .btn.primary { background: linear-gradient(90deg, var(--cyan), var(--purple)); color: #0B0F1A; font-weight: 700; border: none; }
    .note { margin-top: 10px; color: var(--muted); font-size: 12px; }
    .subscribe { margin-top: 16px; padding: 14px; border-radius: 14px; background: var(--glass); border: 1px solid rgba(255,255,255,0.08); }
    .subscribe form { display: flex; gap: 8px; flex-wrap: wrap; }
    .subscribe input { flex: 1 1 180px; padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.15); background: rgba(0,0,0,0.2); color: var(--text); }
    .subscribe button { padding: 10px 14px; border-radius: 8px; border: none; background: var(--cyan); color: #0B0F1A; font-weight: 700; cursor: pointer; }
    .subscribe small { display: block; margin-top: 6px; color: var(--muted); font-size: 12px; }

    .badge-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; font-size: 12px; color: var(--muted); }
    .badge { padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08); }
    .alert-banner { margin-top: 10px; padding: 10px 14px; border-radius: 12px; background: rgba(248,113,113,0.18); border: 1px solid rgba(248,113,113,0.35); font-size: 13px; display: none; }

    .gauge-card { background: var(--panel); padding: 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.08); position: relative; overflow: hidden; min-height: 360px; display:flex; flex-direction:column; justify-content:center; }
    .gauge {
      width: 240px; height: 240px; border-radius: 50%;
      background: conic-gradient(var(--green) 0deg 120deg, var(--yellow) 120deg 240deg, var(--red) 240deg 360deg);
      display: grid; place-items: center; margin: 0 auto; position: relative; animation: pulse 8s ease-in-out infinite;
    }
    .gauge::after {
      content: ""; width: 170px; height: 170px; border-radius: 50%; background: #0B0F1A; border: 1px solid rgba(255,255,255,0.08);
      box-shadow: inset 0 0 30px rgba(0,229,255,0.1);
    }
    .needle {
      position: absolute; width: 6px; height: 110px; background: #fff; border-radius: 999px; top: 25px; left: 50%;
      transform-origin: bottom center; transform: translateX(-50%) rotate(0deg); transition: transform 1.4s ease;
      box-shadow: 0 0 12px rgba(0,229,255,0.6);
    }
    .gauge-center { position: absolute; width: 18px; height: 18px; border-radius: 50%; background: #fff; box-shadow: 0 0 14px rgba(0,229,255,0.7); }

    .section { padding: 48px 0; }
    .section h2 { margin: 0 0 12px 0; font-size: 22px; }
    .section p { margin: 0; color: var(--muted); line-height: 1.7; }

    .brief { background: var(--panel); padding: 20px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.08); }

    .chart-wrap { margin-top: 16px; background: var(--panel); padding: 16px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.08); min-height: 220px; }

    .ads { margin: 24px 0; padding: 18px; border: 1px dashed rgba(255,255,255,0.15); border-radius: 16px; color: var(--muted); font-size: 12px; min-height: 120px; display:flex; align-items:center; justify-content:center; }
    .ads[data-loaded="false"] { opacity: 0.6; }

    .footer-links { display: flex; gap: 16px; flex-wrap: wrap; font-size: 12px; color: var(--muted); }
    .cta-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 14px; }
    .cta-card { padding: 16px; border-radius: 16px; border:1px solid rgba(0,229,255,0.18); background: rgba(12,19,32,0.75); transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .cta-card:hover { transform: scale(1.02); box-shadow: 0 0 24px rgba(0,229,255,0.2); }
    .cta-card a { display:inline-flex; gap:10px; align-items:center; font-weight:700; }
    .cta-card p { margin:8px 0 0 0; color: var(--muted); font-size: 13px; }

    @keyframes pulse {
      0% { filter: drop-shadow(0 0 0 rgba(0,229,255,0.0)); }
      50% { filter: drop-shadow(0 0 20px rgba(0,229,255,0.35)); }
      100% { filter: drop-shadow(0 0 0 rgba(0,229,255,0.0)); }
    }

    @media (max-width: 900px) {
      .hero-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 720px) {
      .hero { min-height: auto; }
      .gauge { width: 200px; height: 200px; }
      .needle { height: 90px; }
    }
  </style>
<!-- Google Analytics GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PQ1DWNMT9K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-PQ1DWNMT9K');
</script>
</head>
<body>
  <div class="container">
    <div class="nav">
      <div class="brand">FinLogicHub5</div>
      <div class="nav-links">
        <a href="/">Daily Risk</a>
        <a href="/weekly/">Weekly Strategy</a>
        <a href="/archive/">Risk Archive</a>
        <a href="/methodology/">Methodology</a>
        <a href="/lab/">Lab</a>
      </div>
    </div>

    <section class="hero">
      <div class="hero-grid">
        <div class="hero-left">
          <div class="title">Global Market Risk Index</div>
          <div class="mri" id="mriValue">--</div>
          <div class="meta">
            <span>Risk Level: <b id="riskLevel">--</b></span>
            <span id="deltaWrap" style="display:none; gap:8px;">
              Î” vs yesterday: <b id="deltaValue">--</b>
            </span>
            <span>Updated: <b id="updatedDate">--</b></span>
          </div>
        </div>

        <div class="hero-right">
          <div class="box-title">Suggested Allocation Range</div>
          <div class="ranges">
            <div>Equity: <b id="equityRange">--</b></div>
            <div>Bonds: <b id="bondsRange">--</b></div>
            <div>Cash: <b id="cashRange">--</b></div>
          </div>
          <div class="cta">
            <a class="btn primary" href="/daily">View Todayâ€™s Full Report â†’</a>
            <a class="btn" href="/weekly">Read Weekly Strategy â†’</a>
          </div>
          <div class="note">Use as exposure guidance, not trading instruction. Not investment advice.</div>
        </div>
      </div>
    </section>

    <div class="ads" data-ad-slot="home-hero" data-loaded="false">Ad Slot â€” Below Hero (reserved)</div>

    <section class="section">
      <h2>What changed today</h2>
      <ul id="driversList"></ul>
    </section>

    <section class="section">
      <h2>Todayâ€™s Actions</h2>
      <div class="cta-grid">
        <div class="cta-card">
          <a href="/daily/" id="actionDaily" data-track="home_cta_click" data-target="daily">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#00E5FF" stroke-width="2"><path d="M3 12h18M12 3l9 9-9 9"/></svg>
            View todayâ€™s full report â†’
          </a>
          <p>Open the latest daily risk report and allocation notes.</p>
        </div>
        <div class="cta-card">
          <a href="/weekly/" data-track="home_cta_click" data-target="weekly">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#00E5FF" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/></svg>
            Read this weekâ€™s strategy â†’
          </a>
          <p>Institutional-style weekly allocation guidance.</p>
        </div>
        <div class="cta-card">
          <a href="/pillar/market-risk-framework/" data-track="home_cta_click" data-target="framework">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#00E5FF" stroke-width="2"><path d="M4 7h16M4 12h16M4 17h10"/></svg>
            Understand the framework â†’
          </a>
          <p>Learn how MRI combines trend, stress, and regime.</p>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>Risk Framework Hub</h2>
      <div class="panel">
        <ul style="margin:0;padding-left:18px;line-height:1.8;">
          <li><a href="/pillar/market-risk-framework/">Market Risk Framework Explained</a> â€” foundational model for regime and allocation signals.</li>
          <li><a href="/pillar/risk-regime-explained/">Risk Regime Explained</a> â€” how risk-on/neutral/risk-off regimes work.</li>
          <li><a href="/pillar/asset-allocation-method/">Asset Allocation Strategy Guide</a> â€” translate MRI into allocation ranges.</li>
          <li><a href="/pillar/market-risk-history-study/">Market Risk Index Model Study</a> â€” historical context and regime cycles.</li>
          <li><a href="/pillar/regime-duration-analysis/">Regime Duration Analysis</a> â€” why duration matters for drawdowns.</li>
          <li><a href="/pillar/how-to-use-mri/">How to Use MRI</a> â€” practical workflow for daily/weekly usage.</li>
          <li><a href="/pillar/risk-signal-vs-timing/">Risk Signal vs Timing</a> â€” avoid noisy market timing.</li>
          <li><a href="/pillar/risk-for-etf-investors/">Risk for ETF Investors</a> â€” risk-aware ETF exposure.</li>
          <li><a href="/pillar/portfolio-risk-management/">Portfolio Risk Management</a> â€” regime-driven guardrails.</li>
          <li><a href="/pillar/risk-threshold-strategy/">Risk Threshold Strategy</a> â€” using high/low risk triggers.</li>
        </ul>
      </div>
    </section>

    <section class="section">
      <h2>Risk Trend (90 Days)</h2>
      <div class="chart-wrap" id="chartWrap">
        <canvas id="riskChart" width="980" height="220" aria-label="90-day risk trend" role="img"></canvas>
      </div>
    </section>

    <div class="ads" data-ad-slot="home-trend" data-loaded="false">Ad Slot â€” Below Risk Chart (reserved)</div>

    <section class="section">
      <h2>Market Risk Brief</h2>
      <div class="brief" id="riskBrief">Loading todayâ€™s brief...</div>
    </section>

    <section class="section">
      <h2>Recommended Next</h2>
      <div class="cta-grid" id="recommendedNext"></div>
    </section>

    <section class="section">
      <h2>Most visited</h2>
      <div class="cta-grid">
        <div class="cta-card"><a href="/archive/" data-track="home_most_visited_click" data-target="archive">Risk archive â†’</a><p>Historical daily reports and regime shifts.</p></div>
        <div class="cta-card"><a href="/risk-levels/" data-track="home_most_visited_click" data-target="risk-levels">Risk levels explained â†’</a><p>Understand risk-on, neutral, risk-off.</p></div>
        <div class="cta-card"><a href="/risk-regime/" data-track="home_most_visited_click" data-target="risk-regime">Risk regime guide â†’</a><p>How regimes change and persist.</p></div>
        <div class="cta-card"><a href="/risk-history/" data-track="home_most_visited_click" data-target="risk-history">Risk history â†’</a><p>Historical MRI cycles and context.</p></div>
        <div class="cta-card"><a href="/market-risk-today/" data-track="home_most_visited_click" data-target="risk-today">Market risk today â†’</a><p>Snapshot of todayâ€™s MRI signal.</p></div>
        <div class="cta-card"><a href="/pillar/risk-regime-explained/" data-track="home_most_visited_click" data-target="pillar-regime">Risk regime explained â†’</a><p>Deep dive into regime mechanics.</p></div>
      </div>
    </section>

    <div class="ads" data-ad-slot="home-footer" data-loaded="false">Ad Slot â€” Footer (reserved)</div>

    <div class="panel" style="margin-top:18px;">
      <h2>Explore More</h2>
      <p><a href="/daily/">Latest Daily</a> Â· <a href="/weekly/">Weekly Strategy</a> Â· <a href="/risk-levels/">Risk Levels</a> Â· <a href="/market-risk-explained/">Market Risk Explained</a> Â· <a href="/pillar/market-risk-framework/">Market Risk Framework</a> Â· <a href="/risk-history/">Risk History</a> Â· <a href="/market-risk-today/">Market Risk Today</a></p>
    </div>
    <div class="footer-links">
      <a href="/market-risk-index.html">Market Risk Index</a>
      <a href="/pages/guides.html">Guides Hub</a>
      <a href="/pages/daily-hub.html">Daily Hub</a>
    </div>
  </div>

  <script>
    const levelMap = { low: 'LOW â€” RISK-ON', medium: 'NEUTRAL', high: 'HIGH â€” RISK-OFF' };

    function formatDelta(delta) {
      if (delta === null || delta === undefined) return '--';
      const sign = delta > 0 ? '+' : '';
      return `${sign}${delta} vs Yesterday`;
    }

    function allocationFor(level) {
      if (level === 'low') return { equity: 'Equity 60â€“80%', bond: 'Bond 10â€“25%', cash: 'Cash 5â€“15%' };
      if (level === 'high') return { equity: 'Equity 20â€“40%', bond: 'Bond 30â€“50%', cash: 'Cash 20â€“30%' };
      return { equity: 'Equity 40â€“60%', bond: 'Bond 20â€“40%', cash: 'Cash 10â€“20%' };
    }

    function alertMessage(alerts) {
      if (!Array.isArray(alerts) || !alerts.length) return '';
      if (alerts.some(a => a.type === 'regime_change')) return 'Risk Alert: Regime Changed';
      if (alerts.some(a => a.type === 'threshold_high')) return 'High Risk Warning';
      if (alerts.some(a => a.type === 'threshold_low')) return 'Low Risk Warning';
      return 'Risk Alert Triggered';
    }

    function animateScore(el, value) {
      const target = Number(value);
      if (!Number.isFinite(target)) { el.textContent = '--'; return; }
      let start = 0;
      const step = () => {
        start += Math.max(1, Math.round(target / 40));
        if (start >= target) { el.textContent = target; return; }
        el.textContent = start;
        requestAnimationFrame(step);
      };
      step();
    }

    function drawChart(canvas, series) {
      const ctx = canvas.getContext('2d');
      const w = canvas.width; const h = canvas.height;
      ctx.clearRect(0,0,w,h);
      ctx.strokeStyle = 'rgba(0,229,255,0.8)';
      ctx.lineWidth = 2;
      ctx.beginPath();
      const max = Math.max(...series, 100);
      const min = Math.min(...series, 0);
      series.forEach((v, i) => {
        const x = (i / (series.length - 1)) * (w - 20) + 10;
        const y = h - 20 - ((v - min) / (max - min || 1)) * (h - 40);
        if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
      });
      ctx.stroke();
      ctx.strokeStyle = 'rgba(255,255,255,0.08)';
      ctx.beginPath();
      ctx.moveTo(10, h - 20);
      ctx.lineTo(w - 10, h - 20);
      ctx.stroke();
    }

    async function loadRisk() {
      return;
    }

    async function loadAlerts() {
      const banner = document.getElementById('alertBanner');
      if (!banner) return;
      try {
        const res = await fetch('/data/risk_alerts.json', { cache: 'no-store' });
        if (!res.ok) return;
        const data = await res.json();
        const alerts = data.alerts || [];
        const msg = alertMessage(alerts);
        if (msg) {
          banner.innerHTML = `${msg} <a href="https://formspree.io/f/FORM_ID" style="color:#E5EDFF; text-decoration:underline; margin-left:8px;">Get Email Alerts</a>`;
          banner.style.display = 'block';
        }
      } catch (e) {}
    }

    async function loadDeltaAndBrief() {
      try {
        const res = await fetch('/data/risk_index_history.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('risk_index_history.json');
        const hist = await res.json();
        const last = hist[hist.length - 1];
        const brief = `Todayâ€™s Market Risk Index (MRI) is ${last?.score ?? '--'} with a ${last?.level ?? 'neutral'} risk profile. The signal summarizes trend, stress, and regime conditions to provide a consistent view of stock market risk. Use the allocation range as a guardrail for position sizing and drawdown control, not as a return forecast. If risk is rising, prioritize capital preservation and rebalance incrementally. If risk is stable, maintain core exposure with discipline. This brief is for risk awareness only and does not constitute investment advice.`;
        const briefEl = document.getElementById('riskBrief');
        if (briefEl) briefEl.textContent = brief;

        const series = hist.slice(-90).map(item => item.score);
        const canvas = document.getElementById('riskChart');
        if (canvas) {
          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                drawChart(canvas, series);
                observer.disconnect();
              }
            });
          });
          observer.observe(canvas);
        }
      } catch (e) {
        const briefEl = document.getElementById('riskBrief');
        if (briefEl) briefEl.textContent = 'Risk brief unavailable.';
      }
    }

    loadRisk();
    loadDeltaAndBrief();
    loadAlerts();

    function updateSession() {
      const sessionEl = document.getElementById('sessionStatus');
      const nextEl = document.getElementById('nextUpdate');
      if (!sessionEl || !nextEl) return;
      const now = new Date();
      const utc = now.getTime() + now.getTimezoneOffset() * 60000;
      const ny = new Date(utc - 5 * 3600000);
      const day = ny.getDay();
      const hour = ny.getHours();
      const open = day > 0 && day < 6 && hour >= 9 && hour < 16;
      sessionEl.textContent = `Session: US Market ${open ? 'Open' : 'Closed'}`;
      const next = new Date(ny);
      if (open) {
        next.setHours(16, 0, 0, 0);
      } else {
        const addDays = day >= 5 ? (8 - day) : (1 - day);
        next.setDate(ny.getDate() + addDays);
        next.setHours(9, 30, 0, 0);
      }
      const diff = Math.max(0, next - ny);
      const h = String(Math.floor(diff / 3600000)).padStart(2, '0');
      const m = String(Math.floor((diff % 3600000) / 60000)).padStart(2, '0');
      nextEl.textContent = `Next update in: ${h}:${m}`;
    }
    setInterval(updateSession, 60000);
    updateSession();

    function trackEvent(name, payload) {
      if (window.track) window.track(name, payload || {});
    }
    document.querySelectorAll('[data-track]').forEach(el => {
      el.addEventListener('click', () => {
        trackEvent(el.dataset.track, { target: el.dataset.target || '' });
      });
    });

    async function loadRecommended() {
      const wrap = document.getElementById('recommendedNext');
      try {
        const dailyRes = await fetch('/data/daily.json', { cache: 'no-store' });
        const daily = dailyRes.ok ? await dailyRes.json() : null;
        const dailyDate = daily?.date;
        const dailyUrl = dailyDate ? `/daily/${dailyDate}` : '/daily/';
        const cards = [
          { title: "Latest Daily Report", desc: "Full daily MRI report and allocation notes.", href: dailyUrl, target: "daily" },
          { title: "This Weekâ€™s Strategy", desc: "Weekly allocation posture and risk summary.", href: "/weekly/", target: "weekly" },
          { title: "Risk Framework Pillar", desc: "Understand MRI model and regime signals.", href: "/pillar/market-risk-framework/", target: "pillar" },
          { title: "Risk History", desc: "Explore historical risk cycles.", href: "/risk-history/", target: "risk-history" }
        ];
        wrap.innerHTML = cards.map(c => `
          <div class="cta-card">
            <a href="${c.href}" data-track="home_recommend_click" data-target="${c.target}">${c.title} â†’</a>
            <p>${c.desc}</p>
          </div>
        `).join('');
        document.querySelectorAll('[data-track="home_recommend_click"]').forEach(el => {
          el.addEventListener('click', () => trackEvent('home_recommend_click', { target: el.dataset.target || '' }));
        });
      } catch (e) {
        wrap.innerHTML = '<div class="cta-card"><a href="/daily/">Latest Daily Report â†’</a><p>Open the latest daily MRI report.</p></div>';
      }
    }
    loadRecommended();

    // Lazy-load ad slots (placeholder for actual ad code)
    const adSlots = document.querySelectorAll('.ads[data-ad-slot]');
    const adObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.dataset.loaded = 'true';
          adObserver.unobserve(entry.target);
        }
      });
    }, { rootMargin: '200px' });
    adSlots.forEach(slot => adObserver.observe(slot));
  </script>
  <script>
(async function () {
  const sources = ["/latest.json", "/data/latest.json", "/risk_index.json"];
  let data = null;

  for (const url of sources) {
    try {
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) continue;
      data = await r.json();
      break;
    } catch (e) {}
  }

  if (!data) return;

  const mri = data.mri ?? data.score ?? "--";
  const riskLevel = data.riskLevel ?? data.level ?? "unknown";
  const equityRange = data.equityRange ?? data.allocation?.equity ?? data.equity ?? "--";
  const bondsRange = data.bondsRange ?? data.allocation?.bonds ?? "--";
  const cashRange = data.cashRange ?? data.allocation?.cash ?? "--";
  const delta = data.delta ?? data.change ?? null;
  const date = data.date ?? (data.updatedAt ? data.updatedAt.slice(0, 10) : "");

  const drivers = Array.isArray(data.drivers) ? data.drivers.slice(0, 3) : [];

  const setText = (id, v) => {
    const el = document.getElementById(id);
    if (el) el.textContent = v;
  };

  setText("mriValue", String(mri));
  setText("riskLevel", String(riskLevel));
  setText("equityRange", String(equityRange));
  setText("bondsRange", String(bondsRange));
  setText("cashRange", String(cashRange));
  setText("updatedDate", date);

  if (delta !== null && document.getElementById("deltaValue")) {
    const wrap = document.getElementById("deltaWrap");
    if (wrap) wrap.style.display = "flex";
    setText("deltaValue", String(delta));
  }

  const drvWrap = document.getElementById("driversList");
  if (drvWrap) {
    drvWrap.innerHTML = "";
    if (drivers.length === 0) {
      drvWrap.innerHTML = "<li>No major change drivers today.</li>";
    } else {
      for (const d of drivers) {
        const li = document.createElement("li");
        li.textContent = d;
        drvWrap.appendChild(li);
      }
    }
  }
})();
  </script>
</body>
</html>
